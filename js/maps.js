function initializeMap(){var a={zoom:10,disableDefaultUI:!0};map=new google.maps.Map(document.querySelector("#mapdiv"),a),window.mapBounds=new google.maps.LatLngBounds}function getPlacesAndDetail(a){function b(a){var b=a.length;for(i=0;i<b;i++){var c=new Location(a[i]);mapViewModel.locations.push(c)}}function c(b,c){function d(a,b){return"marker"==a?null:b}function e(a,b){var c={lat:-34.397,lng:150.644};a||"OK"!==b.status||(c=b.results[0].geometry.location),map.setCenter(c)}if(b)return void getGeocode(a,e);for(var f=c.response.groups[0].items.length,g=0;f>g;g++){var h=c.response.groups[0].items[g],i=new Location;i.name=h.venue.name,i.address=h.venue.location.address?h.venue.location.address:"Address not available",i.lat=h.venue.location.lat,i.lon=h.venue.location.lng,i.phone=h.venue.contact.formattedPhone?h.venue.contact.formattedPhone:"Not Available",i.category=h.venue.categories[0].name?h.venue.categories[0].name:"Category not available",i.marker=makeMapMarker(i),mapViewModel.locations.push(i)}localStorage.setItem(a,JSON.stringify(mapViewModel.locations(),d))}var d;(d=JSON.parse(localStorage.getItem(a)))?b(d):getLocations(a,c)}function getLocations(a,b){var c=new XMLHttpRequest,d="https://api.foursquare.com/v2/venues/explore",e="YAFHOBF2NGR5UJJS4NLNWXCNZBGEMQUBCFA00SFRZLIRM5JO",f="CX2WYTMBELLDEAVQJB3BFFPDWL315NPQK1GYJKL1JZRPBBZX",g=[];g[0]="near="+a,g[1]="client_id="+e,g[2]="client_secret="+f,g[3]="radius=2000",g[4]="v="+(new Date).toISOString().slice(0,10).replace(/-/g,"");var h=d+"?"+g.join("&");c.open("GET",h),c.onreadystatechange=function(){var a,d=!1;4===c.readyState&&(200===c.status?a=JSON.parse(c.responseText):d=!0,b(d,a))},c.send(null)}function makeMapMarker(a){var b=a.lat,c=a.lon,d=a.name,e={lat:b,lng:c},f=window.mapBounds,g=new google.maps.Marker({map:map,position:e,title:d});return a.marker=g,f.extend(new google.maps.LatLng(b,c)),map.fitBounds(f),map.setCenter(f.getCenter()),window.mapBounds=f,google.maps.event.addListener(g,"click",function(){openInfoView(a)}),g}function openInfoView(a){infoWindow.close(),map.setCenter(new google.maps.LatLng(a.lat,a.lon));var b=[];b[0]="<div><strong>"+a.name+"</strong></div>",b[1]="<p>"+a.category+"</p>",b[2]="<p>"+a.address+"</p>",b[3]="<p>Phone No. "+a.phone+"</p>";var c=b.join("");infoWindow.setContent(c),a.marker.setAnimation(google.maps.Animation.BOUNCE),setTimeout(function(){a.marker.setAnimation(null)},1e3),infoWindow.open(map,a.marker)}function getGeocode(a,b){var c=new XMLHttpRequest,d="https://maps.googleapis.com/maps/api/geocode/json?address="+a;c.open("GET",d),c.onreadystatechange=function(){var a,d=!1;4===c.readyState&&(200===c.status?a=JSON.parse(c.responseText):d=!0,b(d,a))},c.send(null)}var map,infoWindow=new google.maps.InfoWindow;window.addEventListener("resize",function(a){map.fitBounds(mapBounds),map.setCenter(mapBounds.getCenter())});